<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Seed Phrase Importance Quiz | DeFi University</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="">
    <link href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@300;400;500;600&family=Inter:wght@300;400;500&display=swap" rel="stylesheet">
    <script type="module">
        import { initializeApp } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js';
        import { getAuth, onAuthStateChanged } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js';
        const firebaseConfig = {
            apiKey: "AIzaSyDuGdDF6jYPcZbQTpbGZPwnl3Qynr-LMWc",
            authDomain: "defi-university-prod.firebaseapp.com",
            projectId: "defi-university-prod",
            storageBucket: "defi-university-prod.firebasestorage.app",
            messagingSenderId: "309871336262",
            appId: "1:309871336262:web:d2dc4be5729ac1d5a6a347"
        };
        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);
        let userToken = null;
        let tracked = false;

        onAuthStateChanged(auth, async (user) => {
            const loginPrompt = document.getElementById('login-prompt');
            const toolContainer = document.getElementById('tool-container');
            const loadingState = document.getElementById('loading-state');
            if (user) {
                userToken = await user.getIdToken();
                if (loginPrompt) loginPrompt.classList.add('hidden');
                if (loadingState) loadingState.classList.add('hidden');
                if (toolContainer) toolContainer.classList.remove('hidden');
            } else {
                if (loadingState) loadingState.classList.add('hidden');
                if (loginPrompt) loginPrompt.classList.remove('hidden');
                if (toolContainer) toolContainer.classList.add('hidden');
                const currentUrl = encodeURIComponent(window.location.href);
                const loginLink = document.querySelector('#login-prompt a');
                if (loginLink) loginLink.href = `/login.html?redirect=${currentUrl}`;
            }
        });

        window.trackInteraction = async function() {
            if (!tracked && userToken) {
                tracked = true;
                try {
                    const response = await fetch('https://api.defiuniversity.xyz/api/progress/interaction', {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json', 'Authorization': `Bearer ${userToken}` },
                        body: JSON.stringify({ courseId: 'crypto-fundamentals', interactionId: 'seed-phrase-quiz', type: 'quiz' })
                    });
                    if (response.ok) {
                        const badge = document.getElementById('points-badge');
                        if (badge) { badge.classList.remove('hidden'); setTimeout(() => badge.classList.add('hidden'), 2500); }
                    }
                } catch (e) { console.error('Tracking error:', e); tracked = false; }
            }
        };
    </script>
    <style>
        body { font-family: 'Inter', sans-serif; background-color: #ffffff; }
        h1, h2, h3, h4, .brand-font { font-family: 'Space Grotesk', sans-serif; }
    </style>
</head>
<body class="bg-white text-neutral-900 min-h-screen p-4 md:p-8">
    <div id="loading-state" class="flex items-center justify-center min-h-[400px]">
        <div class="text-center">
            <div class="w-8 h-8 border-2 border-blue-600 border-t-transparent rounded-full animate-spin mx-auto mb-4"></div>
            <p class="text-neutral-500">Loading tool...</p>
        </div>
    </div>

    <div id="login-prompt" class="hidden max-w-md mx-auto text-center py-12">
        <div class="w-16 h-16 bg-blue-50 rounded-full flex items-center justify-center mx-auto mb-4">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" class="text-blue-600"><rect width="18" height="11" x="3" y="11" rx="2" ry="2"></rect><path d="M7 11V7a5 5 0 0 1 10 0v4"></path></svg>
        </div>
        <h2 class="text-xl font-semibold text-neutral-900 mb-2 brand-font">Sign in Required</h2>
        <p class="text-neutral-500 mb-6">Please sign in to use this interactive tool and earn points.</p>
        <a href="/login.html" class="inline-flex items-center gap-2 px-6 py-3 bg-blue-600 text-white rounded-lg font-semibold hover:bg-blue-700 transition-colors shadow-md shadow-blue-600/20">Sign In</a>
    </div>

    <div id="tool-container" class="hidden max-w-2xl mx-auto">
        <div id="points-badge" class="hidden fixed top-4 right-4 bg-green-50 border border-green-200 text-green-600 px-4 py-2 rounded-full text-sm font-semibold z-50">+25 points earned!</div>
        
        <div class="text-center mb-8">
            <h1 class="text-2xl md:text-3xl font-semibold text-neutral-900 brand-font mb-2">Seed Phrase Importance Quiz</h1>
            <p class="text-neutral-500">Test your understanding of seed phrase security</p>
        </div>

        <div id="quiz-container" class="bg-white border border-neutral-200 rounded-xl p-6 shadow-sm">
            <div id="question-area">
                <!-- Questions will be rendered here -->
            </div>
        </div>

        <div id="results" class="hidden mt-6 bg-white border border-neutral-200 rounded-xl p-6 shadow-sm">
            <div class="text-center mb-6">
                <div id="score-display" class="text-5xl font-bold text-blue-600 mb-2">0/5</div>
                <p id="score-message" class="text-neutral-600"></p>
            </div>
            <div id="review" class="space-y-4"></div>
            <button onclick="restartQuiz()" class="w-full mt-6 px-6 py-3 bg-blue-600 text-white rounded-lg font-semibold hover:bg-blue-700 transition-colors">Take Quiz Again</button>
        </div>
    </div>

    <script>
        const questions = [
            {
                q: "Someone claiming to be 'MetaMask Support' DMs you asking for your seed phrase to 'verify your wallet'. What should you do?",
                options: [
                    "Provide it - they're from the official team",
                    "Give them only half the words",
                    "Never share it - this is 100% a scam",
                    "Ask them to verify their identity first"
                ],
                correct: 2,
                explanation: "No legitimate support will EVER ask for your seed phrase. Anyone asking is a scammer. Real support happens through official channels and never requires sharing your seed phrase."
            },
            {
                q: "What is the BEST way to store your seed phrase backup?",
                options: [
                    "Screenshot saved in your photo gallery",
                    "Written on paper or stamped in metal, stored in a secure physical location",
                    "Saved in a note on your phone",
                    "Emailed to yourself for backup"
                ],
                correct: 1,
                explanation: "Physical, offline storage is safest. Digital storage (phones, email, cloud) can be hacked remotely. Paper or metal stored securely cannot be stolen through the internet."
            },
            {
                q: "Your phone breaks and your wallet app is gone. You have your seed phrase written down. Can you recover your crypto?",
                options: [
                    "No - the crypto is lost with the phone",
                    "Yes - you can restore your wallet on any compatible device using the seed phrase",
                    "Only if you contact customer support",
                    "Only within 30 days"
                ],
                correct: 1,
                explanation: "Your seed phrase IS your wallet. The app is just a window to it. Enter your seed phrase in any compatible wallet software on any device and you'll have full access to your funds."
            },
            {
                q: "How many words are in a typical seed phrase?",
                options: [
                    "6 words",
                    "8 words", 
                    "12 or 24 words",
                    "It varies randomly"
                ],
                correct: 2,
                explanation: "Seed phrases are typically 12 or 24 words from a standardized word list (BIP-39). The words are randomly selected and their order matters - this creates billions of possible combinations."
            },
            {
                q: "You accidentally posted your seed phrase online. What should you do?",
                options: [
                    "Delete the post - you'll be fine",
                    "Immediately transfer all funds to a new wallet with a new seed phrase",
                    "Change your wallet password",
                    "Contact your crypto exchange to freeze it"
                ],
                correct: 1,
                explanation: "Once a seed phrase is exposed, consider that wallet permanently compromised. Create a new wallet immediately, write down the new seed phrase, and transfer all assets. Assume the old wallet can be drained at any moment."
            }
        ];

        let currentQuestion = 0;
        let score = 0;
        let answers = [];

        function renderQuestion() {
            const q = questions[currentQuestion];
            const container = document.getElementById('question-area');
            
            container.innerHTML = `
                <div class="mb-4">
                    <span class="text-sm text-neutral-500">Question ${currentQuestion + 1} of ${questions.length}</span>
                    <div class="w-full bg-neutral-200 rounded-full h-2 mt-2">
                        <div class="bg-blue-600 h-2 rounded-full transition-all" style="width: ${((currentQuestion) / questions.length) * 100}%"></div>
                    </div>
                </div>
                <h3 class="text-lg font-medium text-neutral-900 mb-6">${q.q}</h3>
                <div class="space-y-3">
                    ${q.options.map((opt, i) => `
                        <button onclick="selectAnswer(${i})" class="w-full text-left px-4 py-3 border border-neutral-200 rounded-lg hover:border-blue-300 hover:bg-blue-50 transition-colors">
                            ${opt}
                        </button>
                    `).join('')}
                </div>
            `;
        }

        function selectAnswer(index) {
            const q = questions[currentQuestion];
            const isCorrect = index === q.correct;
            answers.push({ question: currentQuestion, selected: index, correct: q.correct, isCorrect });
            if (isCorrect) score++;

            currentQuestion++;
            if (currentQuestion < questions.length) {
                renderQuestion();
            } else {
                showResults();
            }
        }

        function showResults() {
            document.getElementById('quiz-container').classList.add('hidden');
            document.getElementById('results').classList.remove('hidden');
            
            document.getElementById('score-display').textContent = `${score}/${questions.length}`;
            
            let message = '';
            if (score === questions.length) {
                message = 'üèÜ Perfect! You understand seed phrase security completely!';
            } else if (score >= questions.length - 1) {
                message = 'üëè Excellent! You have a solid understanding of seed phrase security.';
            } else if (score >= questions.length / 2) {
                message = 'üìö Good effort! Review the explanations below to strengthen your understanding.';
            } else {
                message = '‚ö†Ô∏è Please review seed phrase security carefully - this is critical knowledge!';
            }
            document.getElementById('score-message').textContent = message;

            let reviewHTML = '<h4 class="font-semibold text-neutral-900 mb-3">Review</h4>';
            answers.forEach((a, i) => {
                const q = questions[a.question];
                reviewHTML += `
                    <div class="p-4 rounded-lg ${a.isCorrect ? 'bg-green-50 border border-green-200' : 'bg-red-50 border border-red-200'}">
                        <p class="font-medium text-sm mb-2">${i + 1}. ${q.q}</p>
                        <p class="text-sm ${a.isCorrect ? 'text-green-700' : 'text-red-700'}">
                            Your answer: ${q.options[a.selected]} ${a.isCorrect ? '‚úì' : '‚úó'}
                        </p>
                        ${!a.isCorrect ? `<p class="text-sm text-green-700 mt-1">Correct: ${q.options[q.correct]}</p>` : ''}
                        <p class="text-xs text-neutral-600 mt-2">${q.explanation}</p>
                    </div>
                `;
            });
            document.getElementById('review').innerHTML = reviewHTML;
            
            window.trackInteraction();
        }

        function restartQuiz() {
            currentQuestion = 0;
            score = 0;
            answers = [];
            document.getElementById('quiz-container').classList.remove('hidden');
            document.getElementById('results').classList.add('hidden');
            renderQuestion();
        }

        // Initialize
        renderQuestion();
    </script>
</body>
</html>
